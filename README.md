
# Goal
A uniform performant scripting language for use inside any drone or GCSes.

# Uses
FIXME

# Adapter API
A given vehicle/GCS platform must implement an 'adapter' so flsq can run in that environment.

# Design notes

## Mavlink autogenerated code
Mavlink accessor classes are automatically generated from the message
definition XML.  Unfortunately for most vehicles these generated files are too
large to be completely loaded (100K of bytecode).  The solution to this problem
is that we generate one file for each interface, and lazy load the 
implementations as needed.  Considering that most applications only care about
a few mavlink packet types this seems a good solution.


# TODO before first alpha release

flsq /fs/microsd/flsq/startup.nut

* Add license 
* Explain arch
  * Squirrel (modified for Nuttx)
  * Setjmp/longjmp
  * flying squirrel library - user level API for developing squirrel apps for vehicles(flsq)
  * flying squirrel adapter - the C/C++ stub which must be provided for any new autopilot library or GCS

* make adapter layer for px4
* Add debug library
* Make vario proof-of-concept
* Change vehicle init scripts to boot flsq if available
* For Nuttx/P4 handler
  * lower priority
  * use own heap (define sq_malloc)
* For SITL handler
  * implement
* Add install instructions

# TODO before beta release

* Add mechanism so we only ask native code to send us the mavlink packets we are interested in (rather than all packets)

# TODO eventually

* Optionally generate/check CRCs on mavlink packets
* Make the mavlink generated classes more compact, possibly create them
  completely programmatically from arrays that are passed in?
* make a loadbinary() that compiles to binary if necessary and writes the 
  compiled file to disk - to make for faster loading than compiling from src

# Personal notes
https://pixhawk.ethz.ch/px4/dev/gdb_cheatsheet

cd
./configure --enable-ft2232_libftdi
make
sudo make install
sudo modprobe ftdi_sio

# if you fix the ownership the ftdi serial port, you can do without sudo
cd Firmware
sudo openocd -f interface/olimex-arm-usb-ocd-h.cfg -f Debug/stm32f4x.cfg 

arm-none-eabi-gdb /home/kevinh/development/drone/px4/Firmware/makefiles/build/firmware.elf
tar ext :3333
continue
mon cortex_m3 maskisr on

